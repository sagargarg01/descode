class PostComments{constructor(e){this.postId=e,this.postContainer=$("#post-"+e),this.newCommentForm=$(`#post-${e}-comments-form`),this.createComment(e);let t=this;$(" .delete-comment-button",this.postContainer).each((function(){t.deleteComment($(this))}))}createComment(e){let t=this;this.newCommentForm.submit((function(n){n.preventDefault(),length=$(`#post-${e}-comment-length`);$.ajax({type:"post",url:"/comments/create",data:$(this).serialize(),success:function(n){let o=t.newCommentDom(n.data.comment);$("#post-comments-"+e).append(o);let s=n.data.post.comments.length;1==s?length.text(s+" comment"):length.text(s+" comments"),$(`#post-${e}-comments-form input[name=content]`).val(""),t.deleteComment($(" .delete-comment-button",o)),new Noty({theme:"relax",text:"Comment Created!",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))}newCommentDom(e){return $(`\n        <li id="comment-${e._id}">\n        \n            <div class="comment">\n                <a href="/users/profile/${e.user._id}">\n\n                    ${e.user.avatar?`<img class="rounded-circle" width="39" src="${e.user.avatar}" alt="">`:'<img class="rounded-circle" width="39" src="/images/no_profile-b3e3fdee20.jpg" alt="">'}\n        \n\n                    <div class="comment-content ml-2">\n                        <a href="/users/profile/${e.user._id}" class="font-weight-bold">\n                            <span class="text-capitalize">\n                                ${e.user.name}\n                            </span>\n                        </a>\n                </a>\n                            ${e.content}\n                    </div>\n        \n                    <div class="dropdown">\n                        <button class="btn btn-link dropdown-toggle details" type="button" id="gedf-drop1"\n                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                            <i class="fa fa-ellipsis-h"></i>\n                        </button>\n                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="gedf-drop1">\n                            <div class="h6 dropdown-header">Configuration</div>\n                            <a class="dropdown-item" href="#">Save</a>\n                            <a class="delete-comment-button dropdown-item " href="/comments/destroy/${e._id}"> Delete\n                            </a>\n                            <a class="dropdown-item" href="#">Report</a>\n                        </div>\n                    </div>\n            </div>\n        </li>\n        `)}deleteComment(e){let t=$(`#post-${this.postId}-comment-length`);$(e).click((function(n){n.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$("#comment-"+e.data.comment_id).remove();let n=e.data.post.comments.length-1;0==n?t.text(""):1==n?t.text(n+" comment"):t.text(n+" comments"),new Noty({theme:"relax",text:"Comment Deleted!",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))}}